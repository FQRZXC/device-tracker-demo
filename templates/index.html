<!DOCTYPE html>
<html>
<head>
    <title>–ì–µ–æ—Ç—Ä–µ–∫–µ—Ä</title>
    <script>
        function requestGeo() {
            const btn = document.getElementById('geo-btn');
            btn.disabled = true;
            
            const deviceData = {
                screen: {
                    width: screen.width,
                    height: screen.height,
                }
            };

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        deviceData.gps = {
                            lat: pos.coords.latitude,
                            lng: pos.coords.longitude,
                            accuracy: pos.coords.accuracy
                        };
                        sendData(deviceData, true);
                        btn.textContent = "‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã (GPS + –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)";
                    },
                    (err) => {
                        sendData(deviceData, false);
                        btn.textContent = "‚ö†Ô∏è –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã (–¢–æ–ª—å–∫–æ IP)";
                        alert("–í—ã –∑–∞–ø—Ä–µ—Ç–∏–ª–∏ –¥–æ—Å—Ç—É–ø –∫ GPS. –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ.");
                    },
                    { 
                        enableHighAccuracy: true  // –¢–æ—á–Ω—ã–π GPS-—Ä–µ–∂–∏–º
                    }
                );
            } else {
                alert("–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é!");
                btn.textContent = "‚ùå –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞";
            }
        }

        function sendData(data, consent) {
            data.consent = consent;
            fetch('/api/save_data', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
        }
    </script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            margin-top: 50px; 
            background: #f5f5f5;
        }
        button {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            background: #4285F4;
            color: white;
            border: none;
            border-radius: 8px;
            transition: 0.3s;
        }
        button:hover { background: #3367D6; }
        button:disabled { background: #9E9E9E; }
        h1 { color: #4285F4; }
    </style>
</head>
<body>
    <h1>üîç –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è</h1>
    <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è <b>—Ç–æ—á–Ω—ã–º–∏ GPS-–¥–∞–Ω–Ω—ã–º–∏</b>.</p>
    <button id="geo-btn" onclick="requestGeo()">üìç –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–æ–∏ –¥–∞–Ω–Ω—ã–µ</button>
</body>
</html>
